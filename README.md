SELECT 
    CASE WHEN ROW_NUMBER() OVER (PARTITION BY PDI.TC_COIL_NUMBER ORDER BY PDO.TCIP_CIL_END_TIME) = 1 THEN PDI.TC_COIL_NUMBER ELSE '' END AS TC_COIL_NUMBER,
    CASE WHEN ROW_NUMBER() OVER (PARTITION BY PDI.TC_COIL_NUMBER ORDER BY PDO.TCIP_CIL_END_TIME) = 1 THEN PDI.TC_WEIGHT ELSE NULL END AS TC_WEIGHT,
    PDI.TC_ID_Message,
    PDO.TCIP_PRODUCT_COIL,
    PDO.TCPI_ACTUAL_WT,
    PDO.TCIP_CIL_END_TIME
FROM 
    T_COL_COT_PDI_L3 PDI
JOIN 
    T_COL_COIL_INFO_PDO PDO
ON 
    PDI.TC_COIL_NUMBER = PDO.TCIP_INPUT_COIL  
    WHERE REGEXP_LIKE(tc_id_message, '^\d{4}-\d{2}-\d{2}-\d{2}\.\d{2}\.\d{2}\.\d{6}$')
  AND TO_TIMESTAMP(tc_id_message, 'YYYY-MM-DD-HH24.MI.SS.FF6') BETWEEN
      TO_TIMESTAMP('24-APR-25 00:00:01', 'YYYY-MM-DD HH24:MI:SS') AND
      TO_TIMESTAMP('25-APR-25 00:00:01', 'YYYY-MM-DD HH24:MI:SS') 
ORDER BY 
   PDI.TC_ID_Message DESC,
    PDO.TCIP_PRODUCT_COIL

    K541791200	14.24	2025-04-28-20.22.14.251179	K541791210	3.585	28-APR-25 08.54.15.000000000 PM
K541403100	9.48	2025-04-28-19.43.51.656132	K541403110	4.7	28-APR-25 08.22.07.000000000 PM
		2025-04-28-19.43.51.656132	K541403120	2.75	28-APR-25 08.30.49.000000000 PM
		2025-04-28-19.43.51.656132	K541403130	1.965	28-APR-25 08.38.58.000000000 PM
		2025-04-28-19.09.26.864628	K541403230	4.68	28-APR-25 08.07.27.000000000 PM
K541403200	14.145	2025-04-28-19.09.26.864628	K541403210	4.745	28-APR-25 07.37.42.000000000 PM
		2025-04-28-19.09.26.864628	K541403220	4.755	28-APR-25 07.52.28.000000000 PM
K541216100	9.305	2025-04-28-18.51.51.292114	K541216120	4.665	28-APR-25 03.10.06.000000000 PM
		2025-04-28-18.51.51.292114	K541216110	4.64	28-APR-25 03.10.06.000000000 PM
