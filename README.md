CREATE TABLE T_DEBUG_LOG (
  log_id      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  log_time    TIMESTAMP DEFAULT SYSTIMESTAMP,
  module_name VARCHAR2(100),
  h_stm_id    VARCHAR2(4000),
  msg         VARCHAR2(4000),
  sqlcode     NUMBER,
  sqlerrm     VARCHAR2(2000)
);

CREATE OR REPLACE PROCEDURE SP_LOG_DEBUG(
    p_module  IN VARCHAR2,
    p_hstm    IN VARCHAR2,
    p_msg     IN VARCHAR2,
    p_sqlcode IN NUMBER DEFAULT NULL,
    p_sqlerrm IN VARCHAR2 DEFAULT NULL
) IS
  PRAGMA AUTONOMOUS_TRANSACTION;
BEGIN
  INSERT INTO T_DEBUG_LOG(module_name, h_stm_id, msg, sqlcode, sqlerrm)
  VALUES (p_module, p_hstm, SUBSTR(p_msg,1,4000), p_sqlcode, SUBSTR(p_sqlerrm,1,2000));
  COMMIT;
EXCEPTION
  WHEN OTHERS THEN
    NULL; -- avoid failing caller if logging fails
END SP_LOG_DEBUG;
/